<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:lang="http://www.springframework.org/schema/lang" xmlns="http://www.springframework.org/schema/beans"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-2.5.xsd">

	<!-- This context holds all the networking: mina -->

	<bean class="org.springframework.beans.factory.config.CustomEditorConfigurer">
	    <property name="customEditors">
	        <map>
	            <entry key="java.net.SocketAddress" value="org.apache.mina.integration.beans.InetSocketAddressEditor" />
	        </map>
	    </property>
	</bean>
	<!-- RTMP Handler -->

	<bean id="rtmpHandler" class="org.red5.server.net.rtmp.RTMPHandler">

		<property name="server" ref="red5.server" />

		<property name="statusObjectService" ref="statusObjectService" />
	</bean>

	<bean id="rtmpMinaConnManager" class="org.red5.server.net.rtmp.RTMPConnManager">
	</bean>

	<!-- RTMP Mina IO Handler -->

	<bean id="rtmpMinaIoHandler" class="org.red5.server.net.rtmp.RTMPMinaIoHandler">

		<property name="handler" ref="rtmpHandler" />

		<property name="rtmpConnManager" ref="rtmpMinaConnManager" />
	</bean>

	<!-- RTMP Mina Transport -->

	<bean id="rtmpTransport" class="org.red5.server.net.rtmp.RTMPMinaTransport"
		destroy-method="stop" init-method="start">

		<property name="ioHandler" ref="rtmpMinaIoHandler" />

		<property name="connectors">
			<list>
				<bean class="java.net.InetSocketAddress">
					<constructor-arg index="0" type="int" value="1935" />
				</bean>
			</list>
		</property>

		<property name="receiveBufferSize" value="65536" />
		<property name="sendBufferSize" value="271360" />

		<property name="ioThreads" value="16" />
		<!-- This is the interval at which the sessions are polled for stats. If 
			mina monitoring is not enabled, polling will not occur. -->

		<property name="tcpNoDelay" value="true" />
	</bean>

	<!-- RTMP Mina Connection -->

	<bean id="rtmpMinaConnection" class="org.red5.server.net.rtmp.RTMPMinaConnection"
		scope="prototype">

		<!-- Ping clients every X ms. Set to 0 to disable ghost detection code. -->

		<property name="pingInterval" value="5000" />
		<!-- Disconnect client after X ms of not responding. -->

		<property name="maxInactivity" value="60000" />
		<!-- Max. time in milliseconds to wait for a valid handshake. -->

		<property name="maxHandshakeTimeout" value="5000" />
	</bean>

	<bean id="rtmptConnManager" class="org.red5.server.net.rtmp.RTMPConnManager">
	</bean>

	<!-- RTMPT Handler -->

	<bean id="rtmptHandler" autowire="byType"
		class="org.red5.server.net.rtmpt.RTMPTHandler">

		<property name="codecFactory" ref="rtmptCodecFactory" />
	</bean>

	<!-- Use injection to store RTMPT handler in servlet -->

	<bean id="rtmptServlet" class="org.red5.server.net.rtmpt.RTMPTServlet">

		<property name="handler" ref="rtmptHandler" />

		<property name="rtmpConnManager" ref="rtmptConnManager" />
	</bean>

	<!-- RTMPT Connection -->

	<bean id="rtmptConnection" class="org.red5.server.net.rtmpt.RTMPTConnection"
		scope="prototype">

		<!-- Ping clients every X ms. Set to 0 to disable ghost detection code. -->

		<property name="pingInterval" value="5000" />
		<!-- Disconnect client after X ms of not responding. -->

		<property name="maxInactivity" value="60000" />
		<!-- Max. time in milliseconds to wait for a valid handshake. -->

		<property name="maxHandshakeTimeout" value="5000" />
	</bean>

</beans>
